<!DOCTYPE html>
<html>
    <head>
      <!--Import Google Icon Font-->
      <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <!--Import materialize.css-->
      {% load static %}
      <link type="text/css" rel="stylesheet" href="{% static "css/materialize.css" %}"  media="screen,projection"/>
      <link type="text/css" rel="stylesheet" href="{% static "css/style.css" %}"  media="screen,projection"/>

      <!--Let browser know website is optimized for mobile-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    </head>

    <body>
      <header>
        
        <div class="navbar-fixed">
          <nav>
            <div class="container">
              <div class="nav-wrapper">
                <a href="#" data-activates="slide-out" class="button-collapse"><i class="material-icons">menu</i></a>
                <a href="{% url 'index' %}" class="brand-logo">Homie</a>
                <div class="search-wrapper">
                <input id="search" type="search" required>
                <label for="search"><i class="material-icons white-text">search</i></label>
              </div>
            </div>
          </nav>
        </div>

        <aside id="left-sidebar-nav">
          <ul id="slide-out" class="side-nav fixed leftside-navigation">
            <li>
              <div class="userView">
              {% if user.is_authenticated %}
                <img class="background" src="{% static "img/header.png" %}">
                <a href="userp"><img class="circle" src="{% static "img/avatar/" %}{{request.user.id}}.jpg"></a>
                <a href="#!name"><span class="white-text name">{{request.user.username}}</span></a>
                <a href="#!email"><span class="white-text email">{{request.user.email}}</span></a>
                <p><a href="{% url 'logout' %}"><span class="white-text name">登出</a></p>
              {% else %}
                <img class="background" src="{% static "img/header.png" %}">
                <a href="#!user"><img class="circle" src="{% static "img/anonymous.png" %}"></a>
                <p><a href="{% url 'login' %}"><span class="white-text name">登入</a><a href="#!signup"><span class="white-text email">註冊</span></a></p>
              {% endif %}
              </div>
            </li>
            <li><a href="#!">Second Link</a></li>
            <li><div class="divider"></div></li>
            <li><a class="subheader">Subheader</a></li>
            <li><a class="waves-effect" href="#!">Third Link With Waves</a></li>
          </ul>
        </aside>
      </header>

        {% block main_content %}
        {% endblock main_content %}
      
      <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
      {% load static %}
      <script type="text/javascript" src="{% static "js/materialize.min.js" %}"></script>
      <script type="text/javascript" src="{% static "js/app.js" %}"></script>
      <script>
      $(document).ready(function() {
        $('#search').bind('input keyup paste', function(){
            var $this = $(this);
            var delay = 500;

            clearTimeout($this.data('timer'));
            $this.data('timer', setTimeout(function(){
                $this.removeData('timer');
                var q = $this.val();
                if (q) {
                  $.get('{% url "products" %}', {q: $this.val()}, function(resp) {
                    console.log(resp);
                  })
                }
            }, delay));
        });

      })
      </script>
      {% block extra_scripts %}
      {% endblock extra_scripts %}
    </body>
</html>